<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>$FLIP Arena ‚Äì The Cleanest Coin Flip on Base</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <meta name="description" content="$FLIP: The cleanest, fairest on-chain coin flip. Play. Win. Earn. All on Base.">
  <link rel="icon" type="image/png" href="https://cryptologos.cc/logos/base-base-logo.png" />
  <script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.umd.min.js"></script>
  <style>
    /* (Same CSS as before, unchanged for brevity) */
    :root { /* ...styles... */ }
    /* ... (keep your existing styles here, unchanged for now) ... */
  </style>
</head>
<body>
<div class="theme-toggle">
  <button class="theme-btn" data-theme-btn="light" aria-pressed="false">‚òÄÔ∏è</button>
  <button class="theme-btn" data-theme-btn="dark" aria-pressed="false">üåë</button>
</div>
<div class="wallet-bar" id="wallet-bar" style="padding:22px 25px 0 0;">
  <span class="network-badge">Base Mainnet</span>
  <button class="connect-btn" id="connect-btn">Connect Wallet</button>
</div>
<div class="howto-bar">
  <div class="howto-step"><span>1</span>Connect Wallet</div>
  <div class="howto-step"><span>2</span>Flip ETH</div>
  <div class="howto-step"><span>3</span>Win $FLIP & Climb Ranks</div>
</div>
<div class="hero">
  <div class="hero-content">
    <span class="verified" title="Open contract on BaseScan">
      <svg width="22" height="22" fill="none"><circle cx="11" cy="11" r="11" fill="#d1fae5"/><path d="M7.7 11.7 10 14l4.1-4.1" stroke="#22c55e" stroke-width="2.3" stroke-linecap="round"/></svg>
      Verified on <a href="https://basescan.org/address/0x96F65BBB4dB9450840FcbbfD91efAE50654EA56b" target="_blank" style="color:#22c55e;text-decoration:underline;">BaseScan</a>
    </span>
    <h1>$FLIP Arena</h1>
    <p>
      FLIP is the world‚Äôs cleanest, fairest on-chain coin flip.<br>
      Every game is public, every win is real, and you own the outcome.
    </p>
    <div class="progress-wrap" title="FLIP supply progress">
      <div class="progress-bar">
        <div class="progress-inner" id="progress-inner" style="width: 0%"></div>
      </div>
      <div style="font-size:0.98em;margin-top:0.28em;color:var(--secondary);">
        <span id="supply-progress-txt">0 FLIP minted (0%)</span>
      </div>
    </div>
  </div>
  <div class="hero-svg">
    <!-- Flipping coin, spins only on flip -->
    <svg class="flip-coin" id="flip-coin" viewBox="0 0 100 100">
      <defs>
        <radialGradient id="gold" cx="50%" cy="50%" r="60%">
          <stop offset="0%" stop-color="#facc15"/>
          <stop offset="80%" stop-color="#c084fc"/>
          <stop offset="100%" stop-color="#fde68a"/>
        </radialGradient>
      </defs>
      <ellipse cx="50" cy="50" rx="46" ry="46" fill="url(#gold)" stroke="#fde68a" stroke-width="5"/>
      <text x="50" y="58" font-size="38" font-weight="bold" fill="#fff" text-anchor="middle">$</text>
    </svg>
  </div>
</div>
<div class="main-card">
  <div class="stat-row">
    <div class="stat" tabindex="0">
      <span class="stat-label tooltip">Vault
        <span class="tooltip-text">Total ETH in the rewards vault for future winners.</span>
      </span>
      <span class="stat-value" id="vault-balance">‚Äì</span>
      <div class="stat-secondary">ETH Vault</div>
    </div>
    <div class="stat" tabindex="0">
      <span class="stat-label tooltip">Your $FLIP
        <span class="tooltip-text">Your FLIP token balance (auto-updates).</span>
      </span>
      <span class="stat-value" id="flip-balance">‚Äì</span>
      <div class="stat-secondary">Wallet Balance</div>
    </div>
    <div class="stat" tabindex="0">
      <span class="stat-label tooltip">Flips
        <span class="tooltip-text">Total number of flips performed on-chain.</span>
      </span>
      <span class="stat-value" id="total-flips">‚Äì</span>
      <div class="stat-secondary">On-chain</div>
    </div>
    <div class="stat" tabindex="0">
      <span class="stat-label tooltip">Win Rate
        <span class="tooltip-text">Your win % vs. total flips.</span>
      </span>
      <span class="stat-value" id="win-rate">‚Äì</span>
      <div class="stat-secondary">Your Stats</div>
    </div>
  </div>
  <button class="flip-btn" id="flip-btn" disabled>Flip 0.01 ETH</button>
  <div class="feedback" id="feedback"></div>
  <div class="stat-history" id="history-log">
    <b>Recent Flips:</b><br>
    No flips yet. Be the first to flip!
  </div>
</div>
<div class="ticker-wrap">
  <span>‚ö°Ô∏è $FLIP contract: 
    <a href="https://basescan.org/address/0x96F65BBB4dB9450840FcbbfD91efAE50654EA56b" target="_blank" style="color:#facc15;">
      0x96F6...EA56b
    </a> | Total Supply: <span id="flip-supply">10,000,000</span> | 10% Burned per Flip | Vault, Treasury & Dev: On-Chain
  </span>
</div>
<div class="trust-bar">
  <img src="https://cryptologos.cc/logos/base-base-logo.png" alt="Base logo" />  
  Contract open source & verified | <a href="https://basescan.org/address/0x96F65BBB4dB9450840FcbbfD91efAE50654EA56b" target="_blank" style="color:#2563eb;text-decoration:underline;">View on BaseScan</a> | All vault and treasury actions are announced and on-chain.
</div>
<div class="footer">
  <div class="footer-links">
    <a href="https://basescan.org/address/0x96F65BBB4dB9450840FcbbfD91efAE50654EA56b" target="_blank">Smart Contract</a>|
    <a href="#">Whitepaper</a>|
    <a href="#">Tokenomics</a>|
    <a href="#">Leaderboard</a>|
    <a href="#">FAQ</a>
  </div>
  <b>FLIP on Base Mainnet.</b> Built for the future.<br>
  &copy; 2025 FLIP Project. Not investment advice.
</div>
<div class="sticky-flip">
  <button class="flip-btn" id="sticky-flip-btn">Flip Now</button>
</div>
<script>
document.addEventListener('DOMContentLoaded', function () {
  // -- Theme Toggle --
  function setTheme(theme) {
    if (theme === 'light') {
      document.documentElement.setAttribute('data-theme', 'light');
      document.querySelectorAll('.theme-btn')[0].setAttribute('aria-pressed','true');
      document.querySelectorAll('.theme-btn')[1].setAttribute('aria-pressed','false');
    } else {
      document.documentElement.setAttribute('data-theme', 'dark');
      document.querySelectorAll('.theme-btn')[0].setAttribute('aria-pressed','false');
      document.querySelectorAll('.theme-btn')[1].setAttribute('aria-pressed','true');
    }
    localStorage.setItem('flip-theme', theme);
  }
  // Theme toggle listeners
  document.querySelectorAll('.theme-btn').forEach(btn => {
    btn.addEventListener('click', () => setTheme(btn.getAttribute('data-theme-btn')));
  });
  // Init theme on load
  if(localStorage.getItem('flip-theme')==='light'){setTheme('light')}else{setTheme('dark');}

  // -- Wallet Connect --
  let provider, signer, userAddress;
  let FLIP_CONTRACT = "0x96F65BBB4dB9450840FcbbfD91efAE50654EA56b";
  let FLIP_ABI = [ /* TODO: Fill for real integration */ ];

  const connectBtn = document.getElementById('connect-btn');
  if (connectBtn) connectBtn.addEventListener('click', connectWallet);

  async function connectWallet() {
    if (typeof window.ethereum === 'undefined') {
      alert('MetaMask not found! Please install it.');
      return;
    }
    provider = new ethers.providers.Web3Provider(window.ethereum);
    await provider.send("eth_requestAccounts", []);
    signer = provider.getSigner();
    userAddress = await signer.getAddress();
    document.getElementById("wallet-bar").innerHTML = `
      <span class="network-badge">Base Mainnet</span>
      <span style="color:#38bdf8;font-weight:700;font-size:1.09em">${shortAddr(userAddress)}</span>
      <button class="disconnect-btn" id="disconnect-btn">Disconnect</button>`;
    document.getElementById("flip-btn").disabled = false;
    document.getElementById("sticky-flip-btn").disabled = false;
    // Add disconnect button event
    const disconnectBtn = document.getElementById('disconnect-btn');
    if(disconnectBtn) disconnectBtn.onclick = () => window.location.reload();
    // TODO: Fetch user FLIP stats, balances etc.
  }
  function shortAddr(addr) {
    return addr.slice(0,6) + "..." + addr.slice(-4);
  }

  // -- Coin Flip Animation --
  function flipCoin() {
    const coin = document.getElementById("flip-coin");
    coin.classList.add("flipping");
    document.getElementById("feedback").textContent = "Flipping...";
    setTimeout(() => {
      coin.classList.remove("flipping");
      let win = Math.random() > 0.5;
      document.getElementById("feedback").textContent = win ? "üèÜ You won 50 $FLIP!" : "üòÖ You lost (but get 10 $FLIP). Try again!";
      logHistory(win);
    }, 1100);
  }

  document.getElementById("flip-btn").onclick = flipCoin;
  document.getElementById("sticky-flip-btn").onclick = flipCoin;

  // -- Stats (Mock for Demo) --
  let totalFlips = 0, userWins = 0;
  function logHistory(win) {
    totalFlips += 1;
    if(win) userWins += 1;
    let historyLog = document.getElementById("history-log");
    let entry = win ? "üèÜ Won 50 FLIP" : "üòÖ Lost (10 FLIP)";
    let old = historyLog.innerHTML.replace("<b>Recent Flips:</b><br>","");
    historyLog.innerHTML = "<b>Recent Flips:</b><br>" + entry + "<br>" + old;
    document.getElementById("total-flips").textContent = totalFlips;
    document.getElementById("win-rate").textContent = (userWins && totalFlips) ? Math.round(100*userWins/totalFlips)+"%" : "‚Äì";
    // Animate supply
    let minted = totalFlips * 50;
    document.getElementById("supply-progress-txt").textContent = minted + " FLIP minted ("+Math.min(Math.round(minted/10000000*100),100)+"%)";
    document.getElementById("progress-inner").style.width = Math.min(minted/10000000*100,100)+"%";
  }
});
</script>
</body>
</html>

